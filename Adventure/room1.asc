// room script file

int items_to_collect = 7;

function room_Load()
{
    RemoveWalkableArea(2);
    walkingChannel = aWalking_in_snow.Play();
    walkingChannel.Stop();
    backgroundChannel = aScene_1___Beach_theme.Play();
    oStatek.SetView(12);
    oStatek.Animate(0, 10, eRepeat, eNoBlock);
    //cFabien.ChangeRoom(2, 750,  620);
}

function podnies(){
  cFabien.Say("O, to szybciutko do plecaczka wrzuc$, mo+e do zupki jeszcze co* dorzuc$.", eBlock);
}
function czy_wszystkie_przedmioty(){
  if (items_to_collect != 0){
    //cFabien.Say(String.Format("Zostaly %d itemy do zebrania", items_to_collect), eBlock);
  }
  else {
     cFabien.Say("Grunt, +e sk=adniki wszystkie mam przy sobie, wi$c czym pr$dzej do druida wyruszam w drog$.",  eBlock);
  }
}

function oWloszczyzna_Interact()
{
  items_to_collect--;
  //podnies();
  cFabien.Say("W=oszczyzn$ do plecaczka wrzuc$, do zupki j\" dorzuc$.");
  cFabien.Walk(1200, 620,  eBlock,  eWalkableAreas);
  cFabien.FaceObject(oWloszczyzna, eBlock);
  oWloszczyzna.Visible = false;
  cFabien.AddInventory(iWloszczyzna); 
  aPick_up_item.Play();
  czy_wszystkie_przedmioty();
}

function oOgorek_Interact()
{
  items_to_collect--;
  //podnies();
  cFabien.Say("Og'rasy te+ musz$ do plecaczka wrzuci#, +eby zupy nie zadusi#.");
  cFabien.Walk(300, 620,  eBlock,  eWalkableAreas);
  cFabien.FaceObject(oOgorek, eBlock);
  oOgorek.Visible = false;
  cFabien.AddInventory(iOgorek);
  aPick_up_item.Play();
  czy_wszystkie_przedmioty();
}

function oLisc_Interact()
{
  items_to_collect--;
  //podnies();
  cFabien.Say("Li*# laurowy do plecaczka wrzuc$, mo+e do zupki jeszcze co* dorzuc$.");
  cFabien.Walk(1700, 620,  eBlock,  eWalkableAreas);
  cFabien.FaceObject(oLisc, eBlock);
  oLisc.Visible = false;
  cFabien.AddInventory(iLisc); 
  aPick_up_item.Play();
  czy_wszystkie_przedmioty();
}

function oKoper_Interact()
{
  items_to_collect--;
  //podnies();
  cFabien.Say("Koperek na ziemi le+y, nikt mi w to nie uwierzy, wi$c szybko do plecaczka go wrzuc$, do zupki go dorzuc$.");
  cFabien.Walk(500, 620,  eBlock,  eWalkableAreas);
  cFabien.FaceObject(oKoper, eBlock);
  oKoper.Visible = false;
  cFabien.AddInventory(iKoper); 
  aPick_up_item.Play();
  czy_wszystkie_przedmioty();
}

function oKostka_Interact()
{
  items_to_collect--;
  //podnies();
  cFabien.Say("Kostka roso=owa te+ si$ wysypa=a, to j\" w=o+$ do plecaczka, by zupka si$ uda=a.");
  cFabien.Walk(910, 620,  eBlock,  eWalkableAreas);
  cFabien.FaceObject(oKostka, eBlock);
  oKostka.Visible = false;
  cFabien.AddInventory(iKostka);
  aPick_up_item.Play();
  czy_wszystkie_przedmioty();
}

function oZiemniaki_Interact()
{
  //podnies();
  items_to_collect--;
  cFabien.Say("Ziemniaki rozwalone te+ pozbieram, przecie+ do gotowania zupy si$ zabieram.");
  cFabien.Walk(2100, 620,  eBlock,  eWalkableAreas);
  cFabien.FaceObject(oZiemniaki, eBlock);
  oZiemniaki.Visible = false;
  cFabien.AddInventory(iZiemniaki); 
  aPick_up_item.Play();
  czy_wszystkie_przedmioty();
}

function hChatka_Interact()
{ 
  
  if(items_to_collect != 0){
    cFabien.Say("Do Druida i*# nie pora, nie wrzuci=em wszystkiego do wora.");
  }
  else {
    cFabien.Say("Stoi sobie chatka, tutaj Druid mieszka, p$dz$ wi$c do niego, czeka m'j kole+ka.", eBlock);
    RestoreWalkableArea(2);
    cFabien.Walk(2256, 396,  eBlock, eWalkableAreas);
    backgroundChannel.Stop();
    cFabien.LoseInventory(iWloszczyzna);
    cFabien.LoseInventory(iOgorek);
    cFabien.LoseInventory(iKoper);
    cFabien.LoseInventory(iLisc);
    cFabien.LoseInventory(iKostka);
    cFabien.LoseInventory(iZiemniaki);
    cFabien.LoseInventory(iJogurt);
    cFabien.ChangeRoom(2, 750,  620);
  }
}
function room_RepExec()
{
  
  if(cFabien.Moving && !walkingChannel.IsPlaying){
    walkingChannel = aWalking_in_snow.Play(eRepeat);
    walkingSound = true;
  }
  else if(!cFabien.Moving && walkingSound == true){
    walkingSound = false;
    if(walkingChannel.IsPlaying){
      walkingChannel.Stop();
    }
  }
}

function room_AfterFadeIn()
{
  dWelcomeText.Start();
}

function oStatek_AnyClick()
{
  dStatek.Start();
}

function oJogurt_AnyClick()
{
  items_to_collect--;
  cFabien.Say("Ziemniaki rozwalone te+ pozbieram, przecie+ do gotowania zupy si$ zabieram.");
  cFabien.Walk(1500, 620,  eBlock,  eWalkableAreas);
  cFabien.FaceObject(oJogurt, eBlock);
  oJogurt.Visible = false;
  cFabien.AddInventory(iJogurt); 
  aPick_up_item.Play();
  czy_wszystkie_przedmioty();
}
